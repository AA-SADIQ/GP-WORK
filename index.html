<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>KIMC Products</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    </style>
  </head>
  <body class="bg-gray-100 font-sans">
    <nav class="bg-blue-600 p-4 text-white">
      <div class="container mx-auto flex justify-between items-center">
        <h1 class="font-bold text-2xl">KIMC</h1>
        <ul class="flex gap-4">
          <li><a href="home.html" class="hover:underline">Home</a></li>
          <li><a href="products.html" class="hover:underline">Product</a></li>
          <li>
            <a href="newArrival.html" class="hover:underline">New Arrivals</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container mx-auto mt-8 flex flex-col md:flex-row gap-8">
      <section class="w-full md:w-3/4">
        <h1 class="text-3xl font-bold mb-6">Products</h1>
        <div
          id="Product"
          class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
        ></div>
      </section>

      <aside class="w-full md:w-1/4 bg-white p-6 rounded-lg shadow-md h-fit">
        <h2 class="text-2xl font-bold mb-4 border-b pb-2">Your Cart</h2>
        <div id="cart-items">
          <p class="text-gray-500">Your cart is empty.</p>
        </div>
        <div class="mt-4 pt-4 border-t">
          <p class="text-xl font-bold">
            Total: $<span id="cart-total">0.00</span>
          </p>
          <button
            id="checkout-btn"
            class="mt-4 w-full bg-green-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-600 transition-colors duration-300"
          >
            Proceed to Checkout
          </button>
        </div>
      </aside>
    </div>

    <script>
      let cart = []; // This will hold our shopping cart items

      // Function to update the cart display
      function updateCartDisplay() {
        const cartItemsContainer = document.getElementById("cart-items");
        const cartTotalSpan = document.getElementById("cart-total");
        let total = 0;

        if (cart.length === 0) {
          cartItemsContainer.innerHTML =
            '<p class="text-gray-500">Your cart is empty.</p>';
        } else {
          cartItemsContainer.innerHTML = "";
          cart.forEach((item) => {
            const itemElement = document.createElement("div");
            itemElement.className =
              "flex justify-between items-center py-2 border-b";
            itemElement.innerHTML = `
              <span>${item.title}</span>
              <span>$${item.price.toFixed(2)}</span>
            `;
            cartItemsContainer.appendChild(itemElement);
            total += item.price;
          });
        }
        cartTotalSpan.textContent = total.toFixed(2);
      }

      // Function to add a product to the cart
      function addToCart(product) {
        cart.push(product);
        updateCartDisplay();
        alert(`${product.title} has been added to your cart!`);
      }

      // Fetch products and render them
      fetch("https://fakestoreapi.com/products")
        .then((response) => response.json())
        .then((data) => {
          const productContainer = document.getElementById("Product");
          data.forEach((product) => {
            const card = document.createElement("div");
            card.className =
              "bg-white rounded-lg shadow-md hover:shadow-lg p-6 flex flex-col items-center text-center transform transition duration-300 hover:scale-105";

            const imageContainer = document.createElement("div");
            imageContainer.className = "h-48 w-48 mb-4";
            const image = document.createElement("img");
            image.src = product.image;
            image.alt = product.title;
            image.className = "w-full h-full object-contain";
            imageContainer.appendChild(image);
            card.appendChild(imageContainer);

            const title = document.createElement("h3");
            title.className = "text-xl font-semibold mb-2 line-clamp-2";
            title.textContent = product.title;
            card.appendChild(title);

            const category = document.createElement("p");
            category.className = "text-gray-500 text-sm mb-4";
            category.textContent = product.category;
            card.appendChild(category);

            const price = document.createElement("p");
            price.className = "text-2xl font-bold text-gray-800 mt-auto";
            price.textContent = `$${product.price}`;
            card.appendChild(price);

            const button = document.createElement("button");
            button.className =
              "mt-4 w-full bg-blue-500 text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-600 transition duration-300";
            button.textContent = "Add to Cart";

            // Attach the event listener to the button
            button.addEventListener("click", () => {
              addToCart(product);
            });
            card.appendChild(button);

            productContainer.appendChild(card);
          });
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });

      // Attach event listener to the final checkout button
      document.getElementById("checkout-btn").addEventListener("click", () => {
        if (cart.length > 0) {
          const totalCost = cart.reduce((sum, item) => sum + item.price, 0);
          alert(
            `Checking out with ${
              cart.length
            } items. Total cost is $${totalCost.toFixed(2)}.`
          );
          cart = []; // Clear the cart after checkout
          updateCartDisplay();
        } else {
          alert("Your cart is empty!");
        }
      });
    </script>
  </body>
</html>
